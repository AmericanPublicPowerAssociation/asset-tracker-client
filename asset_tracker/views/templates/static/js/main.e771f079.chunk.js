(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{205:function(e,t,n){},206:function(e,t,n){},217:function(e,t,n){e.exports=n(313)},226:function(e,t,n){},311:function(e,t,n){},313:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(68),c=n.n(i),l=n(172),s=n(29),o=n(59),u=n(209),d=("".concat("http","://").concat("18.212.160.114",":").concat(5e3),2),m=4,p=[{id:0,lat:40.796092,lng:-73.961454,name:"Bus 0",product:"Emergency Stop Relay",type_id:m,vendor:"schneider-electric",version:"XPSAC5121"},{id:1,lat:40.695178,lng:-73.84433,name:"Bus 1",product:"TeSys D Contactor",type_id:d,vendor:"schneider-electric",version:"LC1D09G7"},{id:2,lat:40.681711,lng:-73.837683,name:"Bus 2",product:"3-phase monitor",type_id:d,vendor:"siemens",version:"3UG4512-1AR20"},{id:3,lat:40.79502,lng:-73.94425,name:"Bus 3",product:"Thermistor Relay 2",type_id:m,vendor:"siemens",version:"3RN10131BW10"},{id:4,lat:40.799075,lng:-73.951822,name:"Bus 4",product:"relay",type_id:d,vendor:"General Electric",version:"RL4RA031TJ"},{id:5,lat:40.697418,lng:-73.836345,name:"Bus 5",product:"reed switch",type_id:m,vendor:"General Electric",version:"104PXC01"}],f=function(e){return{type:"ADD_ASSET",asset:e}},E=function(e){return{type:"TOGGLE_EDIT",editMode:e}},h=function(e){return{type:"SET_SELECTED",asset:e}},g=function(e){return{type:"RECEIVE_ASSETS",assets:e}},y=function(){return function(e){new Promise(function(e,t){setTimeout(function(){e(p)},500)}).then(function(t){e(g(t))})}},v=function(e){return function(t){(function(e){return new Promise(function(t,n){setTimeout(function(){var n=e.name||"",a=new RegExp(".*".concat(n,".*"),"i"),r=p.filter(function(t){return t.name.match(a)&&(0===e.type_ids.length||e.type_ids.some(function(e){return t.type_id===parseInt(e)}))});t(r)},500)})})(e).then(function(e){t(g(e))})}},b=function(e){return function(t){t({type:"REMOVE_ASSET",id:e.id}),function(e){return new Promise(function(t,n){setTimeout(function(){var n=!1,a=p.length;(p=p.filter(function(t){return t.id!==e})).length<a&&(n=!0),t({sucess:n})},500)})}(e.id).catch(function(){t(f(e)),alert("An error occurred")})}},O=function(e){return function(t){(function(e){return new Promise(function(t,n){setTimeout(function(){e.id=p.length,p=p.concat([e]),t({asset_id:e.id})},500)})})(e).then(function(n){t(f(Object.assign({},e,{id:n})))}).catch(function(){alert("An error occurred")})}},A=function(e){return function(t){(function(e){return new Promise(function(t,n){setTimeout(function(){p=p.map(function(t){return t.id===e.id?e:t}),t({asset_id:e.id})},500)})})(e).then(function(){t(function(e){return{type:"EDIT_ASSET",asset:e}}(e))}).catch(function(){alert("An error occurred")})}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ASSET":return e.concat([t.asset]);case"EDIT_ASSET":return e.map(function(e){return e.id===t.asset.id?t.asset:e});case"REMOVE_ASSET":return e.filter(function(e){return e.id!==t.id});case"RECEIVE_ASSETS":return t.assets;default:return e}},k=Object(o.c)({assets:S,selectedAsset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"SET_SELECTED"===t.type?t.asset:e},editMode:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return"TOGGLE_EDIT"===t.type?t.editMode:e}}),C=n(40),j=n(41),T=n(43),L=n(42),M=n(44),w=n(74),_=n(276),D=n(316),R=n(317),N=n(322),I=n(30),x=n(36),B=n(37),G=n(314),P=n(315),V=n(324),J=n(318);n(226);I.b.add(B.f);var F=function(e){function t(){var e,n;Object(C.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(T.a)(this,(e=Object(L.a)(t)).call.apply(e,[this].concat(r)))).state={query:"",searchTerm:"",searchToggle:!1,type_ids:[]},n}return Object(M.a)(t,e),Object(j.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=this.state,a=n.searchToggle,r=n.searchTerm,i=n.type_ids,c=this.props,l=c.searchAssets,s=c.updateSelected;(a!==t.searchToggle||i.length!==t.type_ids.length||i.length>0&&i.some(function(e,n){return e!==t.type_ids[n]}))&&(s({}),l({name:r,type_ids:i}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.query,a=t.searchTerm,i=this.props.editMode,c=r.a.createElement(G.a,{onChange:function(t){var n=t.target;e.setState(function(e,t){return{type_ids:n.checked?e.type_ids.concat([n.value]):e.type_ids.filter(function(e){return e!==n.value})}})}},["Other","Pole","Meter","Line","Switch","Busbar","Transformer","Substation","Station"].map(function(e,t){return r.a.createElement(P.a,{key:t,value:t},e)}));return r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12},r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12},r.a.createElement("h2",null,'Search: "',a,'" '))),r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12,className:"search-div"},r.a.createElement("form",{onSubmit:function(e){return e.preventDefault()}},r.a.createElement(G.a,null,i?r.a.createElement(V.a,{readOnly:!0,placeholder:"search by name...",value:n,className:"search"}):r.a.createElement(V.a,{onChange:function(t){return e.setState({query:t.target.value})},placeholder:"search by name...",value:n,className:"search"}),r.a.createElement(V.a,{style:i?{cursor:"not-allowed"}:{},componentClass:"button",onClick:function(t){i||e.setState(function(e,t){var n=e.searchToggle;return{searchTerm:e.query.trim(),searchToggle:!n}})},className:"search-btn"},r.a.createElement(x.a,{icon:"search"})," "),r.a.createElement(N.a,null,r.a.createElement(N.a.Heading,null,r.a.createElement(N.a.Title,{toggle:!0},"Filter Search")),r.a.createElement(N.a.Collapse,{onExited:function(t){return e.setState({type_ids:[]})}},r.a.createElement(N.a.Body,null,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(J.a,{style:{paddingLeft:"10px",paddingRight:"10px"}},"Type"),c))))))))))}}]),t}(a.Component),q=Object(s.b)(function(e,t){return{editMode:e.editMode}},function(e,t){return{updateSelected:function(t){e(h(t))},searchAssets:function(t){e(v(t))}}})(F),z=n(73),Y=n(77),U=n(323),K=n(319),H=n(320),W=n(321),X=function(e){var t=e.editMode,n=function(e){t&&e.preventDefault()};return r.a.createElement(U.a,{className:t?"editing":"",fixedTop:!0,collapseOnSelect:!0},r.a.createElement(U.a.Header,null,r.a.createElement(U.a.Brand,null,r.a.createElement(z.a,{to:"/"},"Asset Tracker")),r.a.createElement(U.a.Toggle,null)),r.a.createElement(U.a.Collapse,null,r.a.createElement(K.a,null,r.a.createElement(Y.LinkContainer,{onClick:n,to:"/assets"},r.a.createElement(H.a,{eventKey:1},"Assets")),r.a.createElement(Y.LinkContainer,{onClick:n,to:"#"},r.a.createElement(H.a,{eventKey:2},"Reports")),r.a.createElement(Y.LinkContainer,{onClick:n,to:"#"},r.a.createElement(H.a,{eventKey:3},"Alerts"))),r.a.createElement(K.a,{pullRight:!0},r.a.createElement(Y.LinkContainer,{onClick:n,to:"#"},r.a.createElement(H.a,{eventKey:4},"Alex")),r.a.createElement(Y.LinkContainer,{onClick:n,to:"#"},r.a.createElement(H.a,{eventKey:5},r.a.createElement(W.a,{bsStyle:"primary"},"Sign Out"))))))},Q=Object(s.b)(function(e,t){return{editMode:e.editMode}})(X),Z=n(214),$=(n(303),n(305),n(205),function(e){function t(){return Object(C.a)(this,t),Object(T.a)(this,Object(L.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.loadData)()}},{key:"onGridReady",value:function(e){var t=this;this.gridAPI=e.api,this.gridAPI.sizeColumnsToFit(),window.addEventListener("resize",function(){return t.gridAPI.sizeColumnsToFit()})}},{key:"render",value:function(){var e=this,t=this.props.assets;return r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12,md:12,sm:18},r.a.createElement("div",{className:"ag-theme-balham",style:{height:"100rem",padding:"30px"}},r.a.createElement(W.a,{bsStyle:"primary",onClick:function(t){return e.gridAPI.exportDataAsCsv()}},"Download"),r.a.createElement(Z.AgGridReact,{enableSorting:!0,enableFilter:!0,columnDefs:[{title:"Vendor",field:"vendor"},{title:"Product",field:"product"},{title:"Version",field:"version"}],onGridReady:this.onGridReady.bind(this),rowData:t}))))}}]),t}(a.Component)),ee=Object(s.b)(function(e,t){return{assets:e.assets}},function(e,t){return{loadData:function(){e(y())}}})($);n(206);I.b.add(B.c);var te=function(e){var t=e.className,n=e.asset,a=e.editMode,i=e.onClickEvent,c=a?{cursor:"not-allowed",visibility:"hidden"}:{},l=r.a.createElement(W.a,{style:{float:"left"}},r.a.createElement(x.a,{icon:"map-marker"}));return r.a.createElement(D.a,{className:"asset ".concat(t),style:c,onClick:function(e){return a||i()}},r.a.createElement(R.a,{lg:12},l,r.a.createElement("h5",null,n.product)))};I.b.add(B.d);var ne=function(e){var t=e.assets,n=e.updateSelected,a=e.editMode,i=e.selectedAsset,c=e.toggleEdit,l=t.map(function(e,t){var c=e.id===i.id;return r.a.createElement(te,{className:"".concat(c?"selected":""),editMode:a,onClickEvent:function(){return n(e)},key:t,asset:e})}),s=r.a.createElement(W.a,{style:{float:"right",marginBottom:"10px"},bsStyle:"primary",onClick:function(){n({id:"",lat:"",lng:"",name:"",product:"",type_id:-1,vendor:"",version:""}),c(!0)}},"Add new Asset ",r.a.createElement(x.a,{icon:"plus-circle"}));return r.a.createElement("div",null,r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12},s)),r.a.createElement(D.a,{className:"assets-grid"},r.a.createElement(R.a,{lg:12},l)))},ae=Object(s.b)(function(e,t){return{assets:e.assets,selectedAsset:e.selectedAsset,editMode:e.editMode}},function(e,t){return{updateSelected:function(t){e(h(t))},toggleEdit:function(t){e(E(t))}}})(ne),re=n(92),ie=n(51),ce=n.n(ie),le=(n(309),function(e){function t(){return Object(C.a)(this,t),Object(T.a)(this,Object(L.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=e.props,n=t.markers,a=t.selectedAsset;new Promise(function(e,t){setTimeout(function(){e(JSON.stringify({lat:40.7440823333333,lng:-73.8959806666667}))},500)}).then(function(t){var r=JSON.parse(t),i=r.lat,c=r.lng,l=new ce.a.LngLat(c,i);ce.a.accessToken="pk.eyJ1Ijoic2FsYWgtaGFsYXMiLCJhIjoiY2pwM2QycWdjMDJhNjNwcndmc3hkbzRkZSJ9.0NufwkqqyqJ4isDzf6U4LQ",e.map=new ce.a.Map({container:e.mapContainer,style:"mapbox://styles/mapbox/satellite-v9",center:l,zoom:8}),e.popup=new ce.a.Popup({closeOnClick:!1}),e.editedMarker=new ce.a.Marker({draggable:!0}),e.editedMarker.on("dragend",function(t){var n=t.target.getLngLat(),a=e.props.selectedAsset,r=(a.lat,a.lng,Object(re.a)(a,["lat","lng"]));r.lat=n.lat,r.lng=n.lng,e.props.updateSelected(r)}),e.LAYERNAME="assets",e.map.on("click",e.LAYERNAME,function(t){if(!e.props.editMode){var n=t.features[0].properties.id,a=e.props.markers.find(function(e){return e.id===n});e.props.updateSelected(a)}}),e.map.on("load",function(t){if(n.length){var r=t.target,i=e.createLayer(n,a,r,e.LAYERNAME);r.addLayer(i)}})})}},{key:"componentWillUnmount",value:function(){this.map&&this.map.remove()}},{key:"createLayer",value:function(e,t,n,a){return n.getLayer(a)&&(n.removeLayer(a),n.removeSource(a)),{id:a,type:"circle",source:{type:"geojson",data:{type:"FeatureCollection",features:e.map(function(e){var n=t.id===e.id?1:0;return{type:"Feature",geometry:{type:"Point",coordinates:[e.lng,e.lat]},properties:{type_id:e.type_id,id:e.id,selected:n}}})}},paint:{"circle-radius":6,"circle-color":["match",["get","selected"],1,"red","blue"]}}}},{key:"getBounds",value:function(e){var t=[e[0].lng,e[0].lat];return e.reduce(function(e,t){return e.extend([t.lng,t.lat])},new ce.a.LngLatBounds(t,t))}},{key:"componentDidUpdate",value:function(e,t){if(!this.map)return null;var n=this.props,a=n.editMode,r=n.markers,i=n.selectedAsset,c=Object.keys(i).length>0,l=a?r.filter(function(e){return i.id!==e.id}):r,s=this.createLayer(l,i,this.map,this.LAYERNAME);if(this.map.addLayer(s),c&&!a?this.popup.setLngLat([i.lng,i.lat]).setHTML(i.product).addTo(this.map):this.popup.remove(),a){i.id<0&&""===i.lng&&this.props.updateSelected(Object.assign({},i,this.map.getCenter()));var o={lng:i.lng,lat:i.lat};this.editedMarker.setLngLat(o).addTo(this.map)}else this.editedMarker.remove();var u=e.markers;if(r.length&&(r.length!==u.length||r.some(function(e,t){return e.id!==u[t].id}))&&!a){var d=this.map.getCenter(),m=new ce.a.LngLatBounds(d,d);try{m=this.getBounds(r)}catch(p){p instanceof TypeError&&console.error("markers should have atleast one element",p.message)}finally{this.map.fitBounds(m,{padding:20})}}}},{key:"render",value:function(){var e=this;return r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12},r.a.createElement("div",{style:{zIndex:3,bottom:0,height:"500px",overflow:"hidden",top:0,width:"100%",borderRadius:"25px"},ref:function(t){return e.mapContainer=t}})))}}]),t}(a.Component)),se=Object(s.b)(function(e,t){return{markers:e.assets,selectedAsset:e.selectedAsset,editMode:e.editMode}},function(e,t){return{updateSelected:function(t){e(h(t))}}})(le),oe=n(215),ue=n(216);I.b.add(B.g),I.b.add(B.b),I.b.add(B.e),I.b.add(B.a);var de=function(e){function t(e){var n;return Object(C.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).isValid=function(e){return Object.keys(e).length>0},n.state={editedAsset:{}},n}return Object(M.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.isValid(this.props.asset)&&this.setState(function(t,n){var a=n.asset,r=(a.id,a.lat),i=a.lng,c=Object(re.a)(a,["id","lat","lng"]);return e.ORIGINALCOORDS=[i,r],{editedAsset:c}})}},{key:"componentDidUpdate",value:function(e,t){var n=this,a=n.props.asset,r=n.state.editedAsset;!n.isValid(a)&&n.isValid(r)?n.setState({editedAsset:{}}):n.isValid(a)&&e.asset.id!==a.id&&n.setState(function(e,t){var a=t.asset,r=(a.id,a.lat),i=a.lng,c=Object(re.a)(a,["id","lat","lng"]);return n.ORIGINALCOORDS=[i,r],{editedAsset:c}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.asset,a=t.updateSelected,i=t.deleteAsset,c=t.editMode,l=t.saveAsset,s=t.toggleEdit,o=this.state.editedAsset,u={float:"right"},d="";if(this.isValid(o)&&this.isValid(n)){var m=c?r.a.createElement(W.a,{style:u,bsStyle:"success",onClick:function(e){var t=Object.assign({},o,{id:n.id,lng:n.lng,lat:n.lat});s(!1),l(t)}},"Save Asset ",r.a.createElement(x.a,{icon:"save"})):r.a.createElement(W.a,{style:u,bsStyle:"info",onClick:function(e){return s(!0)}},"Edit Asset ",r.a.createElement(x.a,{icon:"edit"})),p=c?r.a.createElement(W.a,{style:u,bsStyle:"danger",onClick:function(t){var r=""!==n.id?Object.assign({},n,{lng:e.ORIGINALCOORDS[0],lat:e.ORIGINALCOORDS[1]}):{};s(!1),a(r)}},"Cancel ",r.a.createElement(x.a,{icon:"ban"})):r.a.createElement(W.a,{style:u,bsStyle:"danger",onClick:function(e){return i(n)}},"Delete Asset ",r.a.createElement(x.a,{icon:"trash"})),f=Object.entries(o).map(function(t,a){var i=Object(ue.a)(t,2),l=i[0],s=i[1];return c?r.a.createElement("div",{key:a},r.a.createElement("h2",null,l),r.a.createElement(V.a,{onChange:function(t){var n=t.target.value;e.setState(function(e,t){return{editedAsset:Object.assign({},e.editedAsset,Object(oe.a)({},l,n))}})},value:s})):r.a.createElement("div",{key:a},r.a.createElement("h2",null,l),r.a.createElement("p",null,n[[l]]))});d=r.a.createElement("div",{className:"asset-details"},p,m,f)}return r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12},r.a.createElement(N.a,null,r.a.createElement(N.a.Heading,null,r.a.createElement("h1",null,"Asset")),r.a.createElement(N.a.Body,null,d))))}}]),t}(a.Component),me=Object(s.b)(function(e,t){return{asset:e.selectedAsset,editMode:e.editMode}},function(e,t){return{updateSelected:function(t){return e(h(t))},toggleEdit:function(t){e(E(t))},deleteAsset:function(t){return e(b(t))},saveAsset:function(t){""===t.id?e(O(t)):e(A(t))}}})(de),pe=function(e){function t(){return Object(C.a)(this,t),Object(T.a)(this,Object(L.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(j.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Q,null),r.a.createElement(_.a,{fluid:!0},r.a.createElement(w.a,{exact:!0,path:"/assets",render:function(){return r.a.createElement(ee,null)}}),r.a.createElement(w.a,{exact:!0,path:"/",render:function(){return r.a.createElement(D.a,null,r.a.createElement(R.a,{xs:18,md:12,lg:8},r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:12},r.a.createElement(N.a,null,r.a.createElement(N.a.Body,null,r.a.createElement(D.a,null,r.a.createElement(R.a,{lg:8},r.a.createElement(q,null),r.a.createElement(se,null)),r.a.createElement(R.a,{lg:4},r.a.createElement(ae,null)))))))),r.a.createElement(R.a,{xs:18,md:12,lg:4},r.a.createElement(me,null)))}})))}}]),t}(a.Component),fe=(n(311),Object(o.d)(k,Object(o.a)(u.a)));c.a.render(r.a.createElement(s.a,{store:fe},r.a.createElement(l.a,null,r.a.createElement(pe,null))),document.getElementById("root"))}},[[217,2,1]]]);
//# sourceMappingURL=main.e771f079.chunk.js.map